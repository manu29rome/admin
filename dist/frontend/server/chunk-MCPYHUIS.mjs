import './polyfills.server.mjs';
import{h as se}from"./chunk-ODBI26DN.mjs";import{b as te,c as ie,d as ne,f as le,g as ae,h as re,l as oe}from"./chunk-ZORVTJFM.mjs";import{e as V,g as ee,w as y,z as F}from"./chunk-FUK64ECH.mjs";import{Ab as f,Bc as Y,Cb as E,Db as S,E as A,Eb as M,G as U,Ga as w,Gc as Z,Ia as r,Ib as T,Jb as b,Ma as I,N as H,R as j,Ra as G,Va as x,X as m,Y as u,Z as $,fb as c,gb as t,hb as n,ib as v,j as W,jb as J,k as B,kb as Q,lb as h,mb as _,nb as p,qb as P,rb as R,sb as N,v as L,vb as q,wc as K,xc as X,yb as s,zb as g}from"./chunk-6UL7I5E6.mjs";import{h as O}from"./chunk-S6KH3LOX.mjs";var k=class{idTemplateMail;idCompany;name;description;subject;template;isDefault;isInternal;cc;bcc;operation;constructor(l){l&&Object.assign(this,l)}};var D=class i{constructor(l,e){this.authservice=l;this.httpClient=e}TEMPLATES_URL=y.MOD01.concat("/Mails/getIdTemplate");LABELS_URL=y.MOD01.concat("/Mails/getLabels");ADDORUPDATETEMPLATE_URL=y.MOD01.concat("/Mails/addUpdateTemplate");getAllLabels(){let l=new V({Token:this.authservice.getToken()??"","Cache-Control":"no-cache",App:"admin",Pragma:"no-cache"});return this.httpClient.get(this.LABELS_URL,{headers:l}).pipe(A(2),U(1),L(e=>(console.error("Error en la solicitud HTTP:",e),W(null))))}GetTemplateIdCompany(l){let e=`${this.TEMPLATES_URL}?id=${encodeURIComponent(l)}`,o=new V({Token:this.authservice.getToken()??"","Cache-Control":"no-cache",App:"admin",Pragma:"no-cache"});return this.httpClient.get(e,{headers:o}).pipe(A(2),U(1),L(a=>(console.error("Error en la solicitud HTTP:",a),B(()=>a))))}AddUpdateTemplate(l){let e=new V({Token:this.authservice.getToken()??"","Cache-Control":"no-cache",App:"admin",Pragma:"no-cache"});return this.httpClient.post(this.ADDORUPDATETEMPLATE_URL,l,{headers:e})}static \u0275fac=function(e){return new(e||i)(j(F),j(ee))};static \u0275prov=H({token:i,factory:i.\u0275fac,providedIn:"root"})};var ge=["previewIframe"],fe=["previewIframe2"],ve=i=>({color:i}),C=i=>({"background-color":i}),ce=i=>({"border-bottom":i}),pe=()=>({}),de=i=>({"background-color":i,color:"#fff"}),me=()=>({"background-color":"#fff",color:"#111"}),he=i=>({"border-color":i,"border-bottom-width":"2px","border-style":"solid"});function be(i,l){if(i&1&&(t(0,"option",29),s(1),n()),i&2){let e=l.$implicit;c("value",e.idClient),r(),g(e.nameCompany)}}function ye(i,l){if(i&1){let e=h();t(0,"li",33)(1,"div",34)(2,"h3",35),s(3),n()(),t(4,"p",36),s(5),n(),t(6,"div",37)(7,"button",38),_("click",function(){let a=m(e).$implicit,d=p(2);return u(d.selectTemplate(a,1))}),v(8,"img",39),n(),t(9,"button",40),_("click",function(){let a=m(e).$implicit,d=p(2);return u(d.selectTemplate(a,2))}),v(10,"img",41),n()()()}if(i&2){let e=l.$implicit,o=p(2);c("ngStyle",o.mail.idTemplateMail===e.idTemplateMail?b(5,de,o.clientData==null?null:o.clientData.ColorOne):T(7,me)),r(3),f(" ",e.name," "),r(2),f(" ",e.description||"Sin descripci\xF3n disponible."," "),r(3),c("src",o.iconVisible,w),r(2),c("src",o.iconUpdate,w)}}function we(i,l){if(i&1&&(t(0,"div",30)(1,"ul",31),x(2,ye,11,8,"li",32),n()()),i&2){let e=p();r(2),c("ngForOf",e.templatesInternal)}}function Ce(i,l){if(i&1){let e=h();t(0,"li",33)(1,"div",34)(2,"h3",35),s(3),n()(),t(4,"p",36),s(5),n(),t(6,"div",37)(7,"button",38),_("click",function(){let a=m(e).$implicit,d=p(2);return u(d.selectTemplate(a,1))}),v(8,"img",39),n(),t(9,"button",40),_("click",function(){let a=m(e).$implicit,d=p(2);return u(d.selectTemplate(a,2))}),v(10,"img",41),n()()()}if(i&2){let e=l.$implicit,o=p(2);c("ngStyle",o.mail.idTemplateMail===e.idTemplateMail?b(5,de,o.clientData==null?null:o.clientData.ColorOne):T(7,me)),r(3),f(" ",e.name," "),r(2),f(" ",e.description||"Sin descripci\xF3n disponible."," "),r(3),c("src",o.iconVisible,w),r(2),c("src",o.iconUpdate,w)}}function Ee(i,l){if(i&1&&(t(0,"div",30)(1,"ul",42),x(2,Ce,11,8,"li",32),n()()),i&2){let e=p();r(2),c("ngForOf",e.templatesExternal)}}function Se(i,l){if(i&1){let e=h();t(0,"div",67)(1,"button",68),_("click",function(){let a=m(e).$implicit,d=p(3);return u(d.copyToClipboard(a.name))}),t(2,"p",69),s(3),n(),t(4,"p",70),s(5),n()()()}if(i&2){let e=l.$implicit;r(3),g(e.name),r(2),g(e.description)}}function Me(i,l){if(i&1&&(t(0,"div",65),x(1,Se,6,2,"div",66),n()),i&2){let e=p(2);r(),c("ngForOf",e.user)}}function Te(i,l){if(i&1){let e=h();t(0,"div",67)(1,"button",68),_("click",function(){let a=m(e).$implicit,d=p(3);return u(d.copyToClipboard(a.name))}),t(2,"p",69),s(3),n(),t(4,"p",70),s(5),n()()()}if(i&2){let e=l.$implicit;r(3),g(e.name),r(2),g(e.description)}}function ke(i,l){if(i&1&&(t(0,"div",65),x(1,Te,6,2,"div",66),n()),i&2){let e=p(2);r(),c("ngForOf",e.company)}}function Ie(i,l){if(i&1){let e=h();t(0,"div",67)(1,"button",68),_("click",function(){let a=m(e).$implicit,d=p(3);return u(d.copyToClipboard(a.name))}),t(2,"p",69),s(3),n(),t(4,"p",70),s(5),n()()()}if(i&2){let e=l.$implicit;r(3),g(e.name),r(2),g(e.description)}}function Ve(i,l){if(i&1&&(t(0,"div",65),x(1,Ie,6,2,"div",66),n()),i&2){let e=p(2);r(),c("ngForOf",e.rol)}}function Fe(i,l){if(i&1){let e=h();t(0,"div",67)(1,"button",68),_("click",function(){let a=m(e).$implicit,d=p(3);return u(d.copyToClipboard(a.name))}),t(2,"p",69),s(3),n(),t(4,"p",70),s(5),n()()()}if(i&2){let e=l.$implicit;r(3),g(e.name),r(2),g(e.description)}}function De(i,l){if(i&1&&(t(0,"div",65),x(1,Fe,6,2,"div",66),n()),i&2){let e=p(2);r(),c("ngForOf",e.customer)}}function Oe(i,l){if(i&1){let e=h();t(0,"div",67)(1,"button",68),_("click",function(){let a=m(e).$implicit,d=p(3);return u(d.copyToClipboard(a.name))}),t(2,"p",69),s(3),n(),t(4,"p",70),s(5),n()()()}if(i&2){let e=l.$implicit;r(3),g(e.name),r(2),g(e.description)}}function Le(i,l){if(i&1&&(t(0,"div",65),x(1,Oe,6,2,"div",66),n()),i&2){let e=p(2);r(),c("ngForOf",e.desing)}}function Ae(i,l){if(i&1){let e=h();t(0,"span",71),s(1),t(2,"button",72),_("click",function(){let a=m(e).index,d=p(2);return u(d.removeEmail("ccList",a))}),s(3,"x "),n()()}if(i&2){let e=l.$implicit;r(),f(" ",e," ")}}function Ue(i,l){if(i&1){let e=h();t(0,"span",73),s(1),t(2,"button",72),_("click",function(){let a=m(e).index,d=p(2);return u(d.removeEmail("bccList",a))}),s(3,"x"),n()()}if(i&2){let e=l.$implicit;r(),f(" ",e," ")}}function je(i,l){if(i&1){let e=h();t(0,"div",43)(1,"div",44)(2,"p",45),s(3," Etiquetas "),n(),t(4,"div",46)(5,"div",47),_("click",function(){m(e);let a=p();return u(a.toggle("usuario"))}),t(6,"span",48),s(7),n(),t(8,"span",20),s(9),n()(),x(10,Me,2,1,"div",49),n(),t(11,"div",50)(12,"div",47),_("click",function(){m(e);let a=p();return u(a.toggle("compania"))}),t(13,"span",48),s(14),n(),t(15,"span",20),s(16),n()(),x(17,ke,2,1,"div",49),n(),t(18,"div",50)(19,"div",47),_("click",function(){m(e);let a=p();return u(a.toggle("roles"))}),t(20,"span",48),s(21),n(),t(22,"span",20),s(23),n()(),x(24,Ve,2,1,"div",49),n(),t(25,"div",50)(26,"div",47),_("click",function(){m(e);let a=p();return u(a.toggle("customers"))}),t(27,"span",48),s(28),n(),t(29,"span",20),s(30),n()(),x(31,De,2,1,"div",49),n(),t(32,"div",50)(33,"div",47),_("click",function(){m(e);let a=p();return u(a.toggle("desings"))}),t(34,"span",48),s(35),n(),t(36,"span",20),s(37),n()(),x(38,Le,2,1,"div",49),n()(),t(39,"div",51)(40,"p",45),s(41),n(),t(42,"p",52),s(43,"Descripci\xF3n"),n(),t(44,"input",53),M("ngModelChange",function(a){m(e);let d=p();return S(d.mail.description,a)||(d.mail.description=a),u(a)}),n(),t(45,"p",52),s(46,"Asunto"),n(),t(47,"input",53),M("ngModelChange",function(a){m(e);let d=p();return S(d.mail.subject,a)||(d.mail.subject=a),u(a)}),n(),t(48,"p",54),s(49,"Con copia (CC)"),n(),t(50,"div",55),x(51,Ae,4,1,"span",56),t(52,"input",57),_("keydown",function(a){m(e);let d=p();return u(d.addEmail("ccList",a))}),n()(),t(53,"p",54),s(54,"Con copia oculta (BCC)"),n(),t(55,"div",55),x(56,Ue,4,1,"span",58),t(57,"input",57),_("keydown",function(a){m(e);let d=p();return u(d.addEmail("bccList",a))}),n()(),t(58,"p",52),s(59,"Editor HTML"),n(),t(60,"textarea",59),M("ngModelChange",function(a){m(e);let d=p();return S(d.htmlContent,a)||(d.htmlContent=a),u(a)}),_("input",function(){m(e);let a=p();return u(a.updatePreview())}),s(61,"              "),n(),t(62,"div",60)(63,"button",61),_("click",function(){m(e);let a=p();return u(a.openPreviewModal())}),s(64,` Ver HTML
`),n(),t(65,"button",62),v(66,"img",63),s(67," Enviar Correo de Prueba "),n(),t(68,"button",64),_("click",function(){m(e);let a=p();return u(a.OpenModalMessage("update",""))}),v(69,"img",63),s(70," Guardar "),n()()()()}if(i&2){let e=p();r(7),f("Usuario (",(e.user==null?null:e.user.length)??0,")"),r(2),g(e.expanded.usuario?"\u276F":"\uFE3E"),r(),c("ngIf",e.expanded.usuario),r(4),f("Compa\xF1\xEDa (",(e.company==null?null:e.company.length)??0,")"),r(2),g(e.expanded.compania?"\u276F":"\uFE3E"),r(),c("ngIf",e.expanded.compania),r(4),f("Rol (",(e.rol==null?null:e.rol.length)??0,")"),r(2),g(e.expanded.roles?"\u276F":"\uFE3E"),r(),c("ngIf",e.expanded.roles),r(4),f("Cliente (",(e.customer==null?null:e.customer.length)??0,")"),r(2),g(e.expanded.customers?"\u276F":"\uFE3E"),r(),c("ngIf",e.expanded.customers),r(4),f("Otros (",(e.desing==null?null:e.desing.length)??0,")"),r(2),g(e.expanded.desings?"\u276F":"\uFE3E"),r(),c("ngIf",e.expanded.desings),r(3),f("Plantilla ",e.mail.name),r(3),E("ngModel",e.mail.description),r(3),E("ngModel",e.mail.subject),r(4),c("ngForOf",e.ccList),r(5),c("ngForOf",e.bccList),r(4),E("ngModel",e.htmlContent),r(3),c("ngStyle",b(26,C,(e.clientData==null?null:e.clientData.ColorFour)||"#2563eb")),r(2),c("ngStyle",b(28,C,(e.clientData==null?null:e.clientData.ColorThree)||"#2563eb")),r(),c("src",e.iconMailWhite,w),r(2),c("ngStyle",b(30,C,(e.clientData==null?null:e.clientData.ColorOne)||"#2563eb")),r(),c("src",e.iconEditWhite,w)}}function Pe(i,l){if(i&1&&(t(0,"div",74)(1,"div",75)(2,"p",45),s(3),n()(),t(4,"div",76)(5,"div")(6,"h3",77),s(7," Descripci\xF3n "),n(),t(8,"p",78),s(9),n()(),t(10,"div",79)(11,"h3",77),s(12," Asunto "),n(),t(13,"p",78),s(14),n()(),t(15,"div",79)(16,"h3",77),s(17," Con copia (CC): "),n(),t(18,"p",78),s(19),n()(),t(20,"div",79)(21,"h3",77),s(22," Con copia oculta (BCC): "),n(),t(23,"p",78),s(24),n()(),t(25,"div",80),v(26,"iframe",81,0),n()()()),i&2){let e=p();r(3),f("Visualizaci\xF3n ",e.mail.name),r(6),f(" ",e.mail.description||"Sin descripci\xF3n disponible."," "),r(5),f(" ",e.mail.subject||"Sin asunto definido."," "),r(5),f(" ",e.mail.subject||"Sin asunto definido."," "),r(5),f(" ",e.mail.subject||"Sin asunto definido."," ")}}function Re(i,l){if(i&1&&(t(0,"option",29),s(1),n()),i&2){let e=l.$implicit;c("value",e.idClient),r(),g(e.nameCompany)}}function Ne(i,l){if(i&1){let e=h();t(0,"div",82)(1,"div",83)(2,"div",84)(3,"h2",85),s(4,"Nueva Plantilla"),n(),t(5,"button",86),_("click",function(){m(e);let a=p();return u(a.closeAddTemplateModal())}),s(6," \u2715 "),n()(),t(7,"div",87)(8,"div")(9,"label",88),s(10,"* Nombre"),n(),t(11,"input",89),M("ngModelChange",function(a){m(e);let d=p();return S(d.nameTemplate,a)||(d.nameTemplate=a),u(a)}),n()(),t(12,"div")(13,"label",88),s(14,"* Descripci\xF3n"),n(),t(15,"textarea",90),M("ngModelChange",function(a){m(e);let d=p();return S(d.descriptionTemplate,a)||(d.descriptionTemplate=a),u(a)}),n()(),t(16,"div")(17,"label",88),s(18,"* Compa\xF1\xEDa"),n(),t(19,"select",91),M("ngModelChange",function(a){m(e);let d=p();return S(d.idCompany,a)||(d.idCompany=a),u(a)}),x(20,Re,2,2,"option",11),n()(),t(21,"div",92)(22,"button",93),_("click",function(){m(e);let a=p();return u(a.addUpdateTemplate("add"))}),v(23,"img",63),s(24," Guardar "),n()()()()()}if(i&2){let e=p();r(2),c("ngStyle",b(7,he,e.clientData.ColorOne)),r(9),E("ngModel",e.nameTemplate),r(4),E("ngModel",e.descriptionTemplate),r(4),E("ngModel",e.idCompany),r(),c("ngForOf",e.typeCompany),r(2),c("ngStyle",b(9,C,e.clientData.ColorOne)),r(),c("src",e.iconSave,w)}}function ze(i,l){if(i&1&&v(0,"img",105),i&2){let e=p(2);c("src",e.iconDelete,w)}}function We(i,l){if(i&1&&v(0,"img",106),i&2){let e=p(2);c("src",e.iconUpdate,w)}}function Be(i,l){i&1&&(t(0,"div",109),$(),t(1,"svg",110),v(2,"circle",111)(3,"path",112),n()())}function He(i,l){if(i&1){let e=h();J(0),t(1,"button",107),_("click",function(){m(e);let a=p(2);return u(a.optionUpdate?a.addUpdateTemplate("update"):null)}),x(2,Be,4,0,"div",108),t(3,"span"),s(4,"S\xED"),n()(),Q()}if(i&2){let e=p(2);r(),c("ngStyle",b(4,C,e.clientData.ColorOne)),r(),c("ngIf",e.isLoadingBack),r(),q("opacity-0",e.isLoadingBack)}}function $e(i,l){if(i&1){let e=h();t(0,"div",94)(1,"div",95)(2,"div",96)(3,"div",97),x(4,ze,1,1,"img",98)(5,We,1,1,"img",99),n()(),t(6,"h2",100),s(7),n(),t(8,"p",101),s(9),n(),t(10,"div",102)(11,"button",103),_("click",function(){m(e);let a=p();return u(a.closeModalMessage())}),s(12," No "),n(),x(13,He,5,6,"ng-container",104),n()()()}if(i&2){let e=p();r(4),c("ngIf",e.optionDelete),r(),c("ngIf",e.optionUpdate),r(2),g(e.messageTittle),r(2),g(e.messageOption),r(2),c("ngStyle",b(6,C,e.clientData.ColorTwo)),r(2),c("ngIf",e.optionDelete||e.optionUpdate)}}function Ge(i,l){if(i&1&&v(0,"img",121),i&2){let e=p(2);c("src",e.iconSuccessful,w)}}function Je(i,l){if(i&1&&v(0,"img",122),i&2){let e=p(2);c("src",e.iconError,w)}}function Qe(i,l){if(i&1){let e=h();t(0,"div",113)(1,"div",114)(2,"div",96)(3,"div",97),x(4,Ge,1,1,"img",115)(5,Je,1,1,"img",116),n()(),t(6,"h2",117),s(7),n(),t(8,"p",118),s(9),n(),t(10,"div",119)(11,"button",120),_("click",function(){m(e);let a=p();return u(a.messageAddUpdate(a.responseSuccess))}),s(12),n()()()()}if(i&2){let e=p();r(4),c("ngIf",e.responseSuccess),r(),c("ngIf",!e.responseSuccess),r(2),g(e.tittle),r(2),g(e.responseMessage),r(2),c("ngStyle",b(6,C,e.responseSuccess?e.clientData.ColorOne:e.clientData.ColorTwo)),r(),f(" ",e.responseSuccess?"Aceptar":"Entiendo"," ")}}function qe(i,l){if(i&1){let e=h();t(0,"div",123),_("click",function(){m(e);let a=p();return u(a.closePreviewModal())}),t(1,"div",124),_("click",function(a){return m(e),u(a.stopPropagation())}),t(2,"div",125)(3,"div",126)(4,"p",45),s(5),n()(),t(6,"button",127),_("click",function(){m(e);let a=p();return u(a.closePreviewModal())}),s(7," \u2715 "),n()(),t(8,"div",128),v(9,"iframe",81,1),n()()()}if(i&2){let e=p();r(5),f("Visualizaci\xF3n ",e.mail.name)}}var z=class i{constructor(l,e,o){this.authservice=l;this.companyservice=e;this.mailservice=o}iconEditWhite=y.URL_FRONT.concat("/icon/default/editWhite.png");iconMailWhite=y.URL_FRONT.concat("/icon/default/mailWhite.png");iconUpdate=y.URL_FRONT.concat("/icon/default/update.png");iconVisible=y.URL_FRONT.concat("/icon/login/visible-eye.png");iconPlus=y.URL_FRONT.concat("/icon/default/plus.png");iconSave=y.URL_FRONT.concat("/icon/default/save.png");iconDelete=y.URL_FRONT.concat("/icon/default/delete.png");iconSuccessful=y.URL_FRONT.concat("/icon/default/checkblack.png");iconError=y.URL_FRONT.concat("/icon/default/error.png");htmlContent="";title="";messageButton="";errorMessage="";responseMessage="";tittle="";nameTemplate="";idCompany="";descriptionTemplate="";messageOption="";messageTittle="";idDelete="";selectedCompany="";isOpenInternal=!0;isOpenExternal=!1;isUpdate=!1;isLoadingBack=!1;submitted=!1;responseSuccess=!0;showResponseModal=!1;isMessageDelete=!1;showAddTemplateModal=!1;optionDelete=!1;optionUpdate=!1;showHtmlPreview=!1;isEdit=!1;isView=!1;expanded={usuario:!1,compania:!1,roles:!1,customers:!1,desings:!1};mails=[];mail=new k;templatesInternal=null;templatesExternal=[];clientData={};typeCompany=[];company=null;user=null;customer=null;desing=null;rol=null;ccList=[];bccList=[];previewIframe;previewIframe2;ngOnInit(){this.colorDefaul(),this.getAllLabels(),this.companyservice.GetAllTypeStatusDocument().subscribe(l=>{if(l?.success&&l?.data?.length>0){let e=l.data[0];try{this.typeCompany=e?.typeCompany?JSON.parse(e.typeCompany):null,console.log(this.typeCompany),this.typeCompany?.length>0&&this.getAllTemplates(this.typeCompany[0].idClient)}catch(o){console.error("Error al parsear typeCompany:",o)}}})}openPreviewModal(){this.showHtmlPreview=!0,setTimeout(()=>{let l=this.previewIframe2.nativeElement;l.srcdoc=this.htmlContent})}closePreviewModal(){this.showHtmlPreview=!1}messageAddUpdate(l){this.isLoadingBack=!1,l?(this.getAllTemplates(this.mail.idCompany),this.showResponseModal=!1):this.showResponseModal=!1}OpenModalMessage(l,e){return O(this,null,function*(){l=="update"&&(this.messageTittle="Actualizar Plantilla",this.messageOption="\xBFEsta seguro de actualizar los datos de la plantilla?",this.optionDelete=!1,this.optionUpdate=!0,this.idDelete=""),l=="delete"&&(this.messageTittle="Eliminar Plantilla",this.messageOption="\xBFEsta seguro de eliminar La plantilla?",this.optionDelete=!0,this.optionUpdate=!1,this.idDelete=e),this.isMessageDelete=!this.isMessageDelete})}openAddTemplateModal(){this.nameTemplate="",this.idCompany="",this.descriptionTemplate="",this.showAddTemplateModal=!0}closeAddTemplateModal(){this.showAddTemplateModal=!1}addEmail(l,e){let o=e.target,a=o.value.trim();(e.key==="Enter"||e.key===",")&&a&&(this.isValidEmail(a)&&(this[l].push(a.replace(/,$/,"")),o.value=""),e.preventDefault())}removeEmail(l,e){this[l].splice(e,1)}prepareForSend(){this.mail.cc=this.ccList.join(","),this.mail.bcc=this.bccList.join(",")}populateListsFromMail(){this.ccList=(this.mail.cc||"").split(",").map(l=>l.trim()).filter(l=>l),this.bccList=(this.mail.bcc||"").split(",").map(l=>l.trim()).filter(l=>l)}isValidEmail(l){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)}selectTemplate(l,e){return O(this,null,function*(){this.mail=l,this.populateListsFromMail(),e==1?(this.isView=!0,this.isEdit=!1):(this.isEdit=!0,this.isView=!1),this.htmlContent=this.mail.template??"",this.updatePreview(),console.log("Seleccionado:",this.mail)})}getAllLabels(){this.mailservice.getAllLabels().subscribe(l=>{if(l?.success&&l?.data?.length>0){let e=l.data[0];try{this.company=e?.company?JSON.parse(e.company):null,this.user=e?.user?JSON.parse(e.user):null,this.rol=e?.rol?JSON.parse(e.rol):null,this.desing=e?.desing?JSON.parse(e.desing):null,this.customer=e?.customer?JSON.parse(e.customer):null}catch(o){console.error("Error al parsear typeCompany:",o)}}})}getAllTemplates(l){this.mailservice.GetTemplateIdCompany(l).subscribe(e=>{let o=e.data;this.templatesInternal=o.filter(a=>a.isInternal===!0),this.templatesExternal=o.filter(a=>a.isInternal===!1),console.log("Internos:",this.templatesInternal),console.log("Externos:",this.templatesExternal)})}colorDefaul(){let l=this.authservice.getClient();l&&(this.clientData=JSON.parse(l))}updatePreview(){setTimeout(()=>{let l=this.previewIframe.nativeElement;l.srcdoc=this.htmlContent},0)}toggle(l){this.expanded[l]=!this.expanded[l]}copyToClipboard(l){navigator.clipboard.writeText(l).then(()=>{console.log(`Etiqueta "${l}" copiada \u2705`)})}addUpdateTemplate(l){this.isLoadingBack=!0,l=="add"&&(this.mail=new k,this.mail.name=this.nameTemplate,this.mail.idCompany=this.idCompany,this.mail.description=this.descriptionTemplate);let e=this.ValidateDataRol();if(e){this.closeModalMessage(),this.isLoadingBack=!1,this.tittle="Datos Invalidos",this.responseMessage=e,this.responseSuccess=!1,this.showResponseModal=!0;return}this.submitted=!1,this.mail.operation=l,this.mail.template=this.htmlContent,this.prepareForSend(),this.mailservice.AddUpdateTemplate(this.mail).subscribe({next:o=>{o.success?(this.closeModalMessage(),this.getAllTemplates(this.mail.idCompany),this.tittle="\xC9xito",this.responseMessage=o.data?.message||"Operaci\xF3n exitosa",this.mail.idTemplateMail=o.data?.idTemplateMail,this.responseSuccess=!0,this.isLoadingBack=!1):(this.closeModalMessage(),this.tittle="Error",this.responseMessage=o.error?.message||"Ocurri\xF3 un error",this.responseSuccess=!1,this.isLoadingBack=!1),this.showResponseModal=!0},error:o=>{this.closeModalMessage(),this.tittle=o.error?.error?.title||"Error",this.responseMessage=o.error?.error?.message||"Error del servidor al guardar el Template",this.responseSuccess=!1,this.showResponseModal=!0,this.isLoadingBack=!1}})}ValidateDataRol(){return this.submitted=!0,!this.mail?.name||this.mail?.name.trim()===""||!this.mail?.description||this.mail?.description.trim()===""||!this.mail?.idCompany||this.mail?.idCompany.trim()===""?"Por favor, ingresa los datos obligatorios":null}closeModalMessage(){this.isMessageDelete=!1}static \u0275fac=function(e){return new(e||i)(I(F),I(se),I(D))};static \u0275cmp=G({type:i,selectors:[["app-mail"]],viewQuery:function(e,o){if(e&1&&(P(ge,5),P(fe,5)),e&2){let a;R(a=N())&&(o.previewIframe=a.first),R(a=N())&&(o.previewIframe2=a.first)}},decls:40,vars:27,consts:[["previewIframe",""],["previewIframe2",""],[1,"h-[92vh]"],[1,"scale-90","origin-top-left","w-[111%]"],[1,"flex","justify-between","items-center","p-2","pt-[44px]"],[1,"relative","text-lg","font-bold","text-black","p-3","w-full","bg-white/80","justify-center","flex","ml-1","mr-1","mt-4","rounded-2xl"],[3,"ngStyle"],[1,"w-[99%]","px-2","py-2","rounded-xl","bg-white/30","backdrop-blur-md","shadow-lg","m-2","h-auto"],[1,"flex","justify-end","items-center","gap-4"],[1,"text-[16px]","text-black","font-semibold"],[1,"mr-4","min-w-[250px]","border","border-gray-300","rounded-md","p-1","focus:outline-none","transition"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-2","px-4","py-2","rounded-md","text-white","shadow-md","hover:scale-105","transition-transform","duration-200","mr-2",3,"click","ngStyle"],["alt","Nuevo",1,"h-4","w-4","object-cover",3,"src"],[1,"text-sm","font-semibold"],[1,"w-full","h-screen","p-2","grid","grid-cols-10","gap-2","mb-2","max-lg:grid-cols-1","max-lg:h-auto","relative"],[1,"col-span-2","bg-white","rounded-2xl","shadow","gap-2","h-[800px]"],[1,"text-ms","font-semibold","p-2","w-full","text-center"],[1,"flex"],[1,"w-full","flex","justify-between","items-center","p-2","text-sm","font-semibold","text-gray-800","hover:bg-gray-50","rounded-t-2xl",3,"click","ngStyle"],[1,"text-gray-500"],["class","p-2 border-t",4,"ngIf"],[1,"col-span-8","grid","grid-cols-1","gap-2"],["class","flex gap-2",4,"ngIf"],["class","bg-white rounded-xl shadow-md flex flex-col h-[800px]",4,"ngIf"],["class","fixed inset-0 z-50 flex items-center justify-center bg-black/50",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",4,"ngIf"],["class","fixed top-0 left-0 w-full h-full flex items-center justify-center bg-black bg-opacity-40 z-50 backdrop-blur-sm transition duration-300",4,"ngIf"],["class","fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",3,"click",4,"ngIf"],[3,"value"],[1,"p-2","border-t"],[1,"space-y-3","h-[700px]","overflow-y-auto","pr-2"],["class","cursor-pointer rounded-2xl shadow-sm hover:shadow-lg transition transform hover:-translate-y-1 p-5 border border-gray-200",3,"ngStyle",4,"ngFor","ngForOf"],[1,"cursor-pointer","rounded-2xl","shadow-sm","hover:shadow-lg","transition","transform","hover:-translate-y-1","p-5","border","border-gray-200",3,"ngStyle"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-base","font-semibold","truncate"],[1,"text-sm","line-clamp-2"],[1,"flex","items-center","justify-end","gap-6","mt-2","border-t","pt-2"],["title","Ver",1,"p-2","rounded-full","bg-blue-50","hover:bg-blue-100","transition","shadow",3,"click"],["alt","Ver",1,"w-5","h-5","opacity-70",3,"src"],["title","Editar",1,"p-2","rounded-full","bg-yellow-50","hover:bg-yellow-100","transition","shadow",3,"click"],["alt","Editar",1,"w-5","h-5","opacity-70",3,"src"],[1,"space-y-3","h-[800px]","overflow-y-auto","pr-2"],[1,"flex","gap-2"],[1,"w-[25%]","bg-white","rounded-xl","shadow-md","gap-2","flex","flex-col","border","border-gray-200","p-2","h-[800px]","overflow-y-auto"],[1,"text-ms","font-semibold","w-full","text-center"],[1,"border-b","border-gray-200","gap-2","pb-2"],[1,"flex","justify-between","items-center","cursor-pointer",3,"click"],[1,"font-semibold","text-gray-700","text-sm"],["class","mt-2 space-y-2",4,"ngIf"],[1,"border-b","border-gray-200","pb-2"],[1,"w-[75%]","bg-white","rounded-xl","shadow-md","p-2","flex","flex-col","h-[800px]","gap-2"],[1,"text-sm","font-semibold","text-blac"],["type","text",1,"flex-1","border","rounded","p-2","text-sm","max-h-[30px]","focus:outline-none",2,"background-color","#EEEDED",3,"ngModelChange","ngModel"],[1,"text-sm","font-semibold","text-black"],[1,"flex","flex-wrap","gap-1","border","rounded","p-1","bg-gray-100","max-h-[70px]","overflow-y-auto"],["class","flex items-center bg-blue-200 rounded-full px-2 py-1 text-sm",4,"ngFor","ngForOf"],["type","text","placeholder","Escribe correo y Enter",1,"flex-1","bg-transparent","outline-none","text-sm","min-w-[120px]",2,"background-color","#EEEDED",3,"keydown"],["class","flex items-center bg-green-200 rounded-full px-2 py-1 text-sm",4,"ngFor","ngForOf"],["placeholder","Escribe tu c\xF3digo HTML aqu\xED...",1,"flex-1","border","rounded","p-2","font-mono","text-sm","resize-none","focus:outline-none",2,"background-color","#EEEDED",3,"ngModelChange","input","ngModel"],[1,"flex","justify-end","gap-2","m-2","w-full","pr-4"],[1,"shadow-lg","h-[30px]","w-[25%]","min-w-[100px]","text-white","font-semibold","rounded-[20px]","text-sm","flex","items-center","justify-center","gap-2","transition-transform","duration-200","hover:scale-105",3,"click","ngStyle"],[1,"shadow-lg","h-[30px]","w-[25%]","min-w-[250px]","text-white","font-semibold","rounded-[20px]","text-sm","flex","items-center","justify-center","gap-2","transition-transform","duration-200","hover:scale-105",3,"ngStyle"],["alt","Perfil",1,"w-3.5","h-3.5","object-contain",3,"src"],[1,"shadow-lg","h-[30px]","w-[25%]","min-w-[150px]","text-white","font-semibold","rounded-[20px]","text-sm","flex","items-center","justify-center","gap-2","transition-transform","duration-200","hover:scale-105",3,"click","ngStyle"],[1,"mt-2","space-y-2"],["class","flex justify-between items-center",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center"],[1,"p-2","rounded-lg","bg-gray-50","hover:bg-gray-100","transition","cursor-pointer","w-full","text-left",3,"click"],[1,"text-sm","font-semibold","text-gray-600","leading-tight","pl-2"],[1,"text-xs","text-gray-500","pl-2"],[1,"flex","items-center","bg-blue-200","rounded-full","px-2","py-1","text-sm"],["type","button",1,"ml-1","text-red-600","hover:text-red-800",3,"click"],[1,"flex","items-center","bg-green-200","rounded-full","px-2","py-1","text-sm"],[1,"bg-white","rounded-xl","shadow-md","flex","flex-col","h-[800px]"],[1,"p-2","border-b"],[1,"p-6"],[1,"text-sm","font-semibold","text-black","tracking-wide"],[1,"text-gray-700","mt-1"],[1,"mt-2"],[1,"h-[500px]","mt-2"],[1,"w-full","h-full","border-none","rounded"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50"],[1,"bg-white","rounded-2xl","shadow-xl","w-full","max-w-md","p-6"],[1,"relative","mb-4","text-center",3,"ngStyle"],[1,"text-[17px]","leading-normal","font-semibold","text-black","pb-2"],[1,"absolute","right-0","top-1/2","-translate-y-1/2","text-gray-900","hover:text-gray-400","text-[17px]","leading-normal","font-semibold","transition","duration-200","pb-2",3,"click"],[1,"space-y-2"],[1,"font-semibold","text-sm"],["type","text","placeholder","Nombre de la plantilla",1,"block","w-full","px-3","py-2","rounded-md","shadow-sm","focus:outline-none","text-sm","font-semibold",2,"background-color","#EEEDED",3,"ngModelChange","ngModel"],["rows","3","placeholder","Descripci\xF3n breve",1,"block","w-full","px-3","py-2","rounded-md","shadow-sm","focus:outline-none","text-sm","font-semibold",2,"background-color","#EEEDED",3,"ngModelChange","ngModel"],[1,"w-full","rounded-lg","border","border-gray-300","p-2","border-gray-300","rounded-md","p-1","focus:outline-none",2,"background-color","#EEEDED",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-3","pt-4"],["type","button",1,"hover:scale-105","transition-transform","duration-200","flex","items-center","h-[30px]","text-sm","items-center","justify-center","gap-2","rounded-[20px]","w-[48%]","justify-center","text-white",3,"click","ngStyle"],[1,"fixed","inset-0","bg-black","bg-opacity-40","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-xl","shadow-2xl","px-6","py-8","w-[90%]","max-w-[400px]","text-center","relative"],[1,"flex","justify-center","mb-4"],[1,"bg-gray-100","rounded-full","p-4","shadow-inner"],["alt","Eliminar","class","h-14",3,"src",4,"ngIf"],["alt","Actualizar","class","h-14",3,"src",4,"ngIf"],[1,"text-lg","font-bold","text-gray-900"],[1,"text-sm","text-gray-600","mt-2"],[1,"flex","justify-center","gap-3","mt-6","flex-wrap"],[1,"h-[30px]","text-sm","items-center","justify-center","gap-2","rounded-full","font-semibold","text-white","shadow-md","hover:shadow-lg","transition","w-[100px]",3,"click","ngStyle"],[4,"ngIf"],["alt","Eliminar",1,"h-14",3,"src"],["alt","Actualizar",1,"h-14",3,"src"],[1,"relative","h-[30px]","text-sm","items-center","justify-center","gap-2","rounded-full","font-semibold","text-white","shadow-md","hover:shadow-lg","transition","w-[100px]",3,"click","ngStyle"],["class","absolute inset-0 flex items-center justify-center",4,"ngIf"],[1,"absolute","inset-0","flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z",1,"opacity-75"],[1,"fixed","top-0","left-0","w-full","h-full","flex","items-center","justify-center","bg-black","bg-opacity-40","z-50","backdrop-blur-sm","transition","duration-300"],[1,"bg-white","rounded-2xl","shadow-xl","p-8","w-[90%]","max-w-[400px]","text-center","animate-fade-in"],["alt","\xC9xito","class","h-16 transition-transform duration-300 hover:scale-110",3,"src",4,"ngIf"],["alt","Error","class","h-16 transition-transform duration-300 hover:scale-110",3,"src",4,"ngIf"],[1,"text-lg","font-bold","text-gray-800"],[1,"text-gray-600","mt-2","text-sm"],[1,"mt-6"],[1,"w-full","h-[30px]","text-sm","items-center","justify-center","gap-2","rounded-[14px]","font-semibold","text-white","transition","duration-200","hover:brightness-110","shadow-md",3,"click","ngStyle"],["alt","\xC9xito",1,"h-16","transition-transform","duration-300","hover:scale-110",3,"src"],["alt","Error",1,"h-16","transition-transform","duration-300","hover:scale-110",3,"src"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/60","backdrop-blur-sm",3,"click"],[1,"bg-white","w-[90%]","max-w-5xl","h-[90vh]","rounded-2xl","shadow-2xl","overflow-hidden","relative","p-2",3,"click"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"p-2","border-b","w-full"],[1,"text-gray-600","hover:text-gray-900","text-2xl",3,"click"],[1,"w-full","h-full"]],template:function(e,o){e&1&&(t(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"span",6),s(5,"Gestor de Correos "),n()()(),t(6,"div",7)(7,"div",8)(8,"h2",9),s(9,"Seleccionar Compa\xF1\xEDa"),n(),t(10,"select",10),x(11,be,2,2,"option",11),n(),t(12,"button",12),_("click",function(){return o.openAddTemplateModal()}),v(13,"img",13),t(14,"span",14),s(15,"Nueva Plantilla Externa"),n()()(),t(16,"div",15)(17,"div",16)(18,"p",17),s(19,"Plantillas"),n(),t(20,"div",18)(21,"button",19),_("click",function(){return o.isOpenInternal=!o.isOpenInternal,o.isOpenExternal=!1}),t(22,"span"),s(23),n(),t(24,"span",20),s(25),n()(),t(26,"button",19),_("click",function(){return o.isOpenExternal=!o.isOpenExternal,o.isOpenInternal=!1}),t(27,"span"),s(28,"Externas"),n(),t(29,"span",20),s(30),n()()(),x(31,we,3,1,"div",21)(32,Ee,3,1,"div",21),n(),t(33,"div",22),x(34,je,71,32,"div",23)(35,Pe,28,5,"div",24),n()()()()(),x(36,Ne,25,11,"div",25)(37,$e,14,8,"div",26)(38,Qe,13,8,"div",27)(39,qe,11,1,"div",28)),e&2&&(r(4),c("ngStyle",b(17,ve,o.clientData.ColorOne)),r(7),c("ngForOf",o.typeCompany),r(),c("ngStyle",b(19,C,o.clientData.ColorOne)),r(),c("src",o.iconPlus,w),r(8),c("ngStyle",o.isOpenInternal?b(21,ce,"3px solid "+(o.clientData==null?null:o.clientData.ColorOne)):T(23,pe)),r(2),f("Internas (",(o.templatesInternal==null?null:o.templatesInternal.length)??0,")"),r(2),g(o.isOpenInternal?"\u276F":"\uFE3E"),r(),c("ngStyle",o.isOpenExternal?b(24,ce,"3px solid "+(o.clientData==null?null:o.clientData.ColorOne)):T(26,pe)),r(4),g(o.isOpenExternal?"\u276F":"\uFE3E"),r(),c("ngIf",o.isOpenInternal),r(),c("ngIf",o.isOpenExternal),r(2),c("ngIf",o.isEdit),r(),c("ngIf",o.isView),r(),c("ngIf",o.showAddTemplateModal),r(),c("ngIf",o.isMessageDelete),r(),c("ngIf",o.showResponseModal),r(),c("ngIf",o.showHtmlPreview))},dependencies:[oe,ae,re,te,le,ie,ne,Z,K,X,Y],styles:[".scrollbar-hide[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.scrollbar-hide[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none}button[_ngcontent-%COMP%]{transition:background-color .3s ease-in-out,transform .2s ease}"]})};export{z as default};
